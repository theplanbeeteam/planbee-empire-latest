{"version":3,"sources":["webpack:///./node_modules/just-debounce/index.js","webpack:///./source/scripts/helpers/ScrollLock.js","webpack:///./node_modules/shopify-asyncview/dist/index.es.js","webpack:///./source/scripts/components/Modal.js","webpack:///./source/scripts/helpers/LazyLoader.js","webpack:///./source/scripts/components/ProductQuickshop.js","webpack:///./source/scripts/components/GridItemSwatches.js","webpack:///./source/scripts/components/ProductGridItem.js","webpack:///./node_modules/vanilla-modal/dist/index.js","webpack:///./source/scripts/helpers/ProductReviews.js"],"names":["document","body","html","querySelector","_blockScroll","event","target","closest","preventDefault","stopPropagation","ScrollLock","modal","classList","add","style","top","window","pageYOffset","addEventListener","passive","querySelectorAll","forEach","remove","removeEventListener","contains","Modal","callbacks","$body","$","$window","$modal","$modalInner","find","trigger","defaultCallbacks","onOpen","onClose","onBeforeOpen","onBeforeClose","extend","finishedLoading","bind","_onOpen","_onBeforeOpen","_onClose","_onBeforeClose","_closeEsc","position","modalOptions","loadClass","class","transitions","isOpen","destroy","unlock","selector","handle","_addModalClass","VanillaModal","open","closeEsc","close","trapFocus","e","key","windowHeight","innerHeight","modalHeight","outerHeight","modalPadding","parseInt","css","offset","marginTop","addClass","modalClass","attr","match","removeClass","_removeModalClass","off","removeTrapFocus","activeElement","focus","lock","on","debounce","LazyLoader","callback","options","defaultOptions","rootMargin","threshold","_runCallback","observer","IntersectionObserver","observe","entries","isIntersecting","unload","disconnect","ProductQuickshop","$el","id","initialVariant","quickShopSelector","$quickShop","quickshopSpinner","loaded","richText","productDetails","openingAddToCart","url","data","hash","modalCallbacks","_open","_close","atcCallbacks","onInit","_onATCInit","onError","_onATCError","onSuccess","_onATCSuccess","_onATCClose","_initialize","$quickShopModalContent","AsyncView","load","view","then","content","initShopifyProductReviews","setupRippleEffect","Shopify","PaymentButton","init","$message","$formArea","gallery","$details","$description","context","settings","product","_onQuickshopLoaded","catch","length","RichText","useHistory","isQuickshop","requestAnimationFrame","ProductDetails","empty","_toggleMessage","message","isVisible","toggleClass","error","$content","swatchGap","GridItemSwatches","el","setInitialVariant","expanded","swatchImages","swatchVariantIds","selectedImage","state","events","EventHandler","JSON","parse","innerHTML","variants","swatchesContainer","cardLinks","cardLinkHref","getAttribute","activeControlTime","activeControl","isPreselected","swatches","swatchCount","swatchCountWrapper","swatchWidths","Array","prototype","map","call","swatch","getBoundingClientRect","width","resize","originalImages","primary","alternate","disableUnavailable","register","_toggleExpanded","injectImagesMouseoverEvent","_injectImages","injectImagesFocusinEvent","_handleMouseOver","_handleMouseLeave","_handleClick","_handleChange","_handleSwatchFocus","availableSwatches","variant","available","swatchOptionKey","swatchInputs","value","disabled","availableWidth","getComputedStyle","paddingRight","newShowSwatchCount","cumulativeWidth","i","getSwatchGap","showSwatchCount","index","left","display","innerText","unregister","imagesInjected","tempContainer","createDocumentFragment","featuredImage","tempEl","createElement","img","appendChild","swatchValue","imageString","variantId","imagesContainer","salesBadge","insertBefore","rimg","watch","_setState","swatchName","primaryImage","hideAlternateImage","oldPrimaryImg","href","link","setAttribute","visibility","Date","now","checked","hasAttribute","dataset","swatchTooltip","nextElementSibling","swatchesEl","getPropertyValue","unregisterAll","ProductGridItem","productQuickshop","quickshopInitialVariant","quickBuySettings","actionsOpen","defaultView","grid_list","lazy","lazyLoader","_init","$html","actions","quickBuyEl","quickshopSlimEl","quickshopFullEl","hasProductActions","_addToCart","_actionsToggle","_openQuickShop","_setSortByQueryParameters","hasClass","$script","expandAnimation","transition","quickbuyEl","_initQuickBuy","_objectFitPolyfill","queryParams","location","search","aCouples","substr","split","aKeyValue","decodeURIComponent","text","console","warn","leftThumbsClass","currentTarget","documentElement","_isObjectFitAvailable","$figure","featuredSrc","alternateSrc","height","actionsHeight","heightBase","heightExpanded","layout","isGreaterThanBreakpoint","$currentTarget","$target","openProductItem","productHasFocus","is","parents","first","type","_showActions","_hideActions","_getHeights","setProperty","animateTo","focusinEvent","removeAttribute","addToCartFlyout","atcButton","variantID","formData","name","moneyFormat","money_format","cartRedirection","cart_redirection","AddToCartFlyout","SPR","registerCallbacks","initRatingHandler","initDomEls","loadProducts","loadBadges"],"mappings":";;;;;AAAA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;gBCjCiBA,Q;IAATC,I,aAAAA,I;AACR,IAAMC,IAAI,GAAGF,QAAQ,CAACG,aAAT,CAAuB,MAAvB,CAAb;;AAEA,SAASC,YAAT,CAAsBC,KAAtB,EAA6B;AAC3B;AACA,MAAIA,KAAK,CAACC,MAAN,CAAaC,OAAb,CAAqB,4BAArB,CAAJ,EAAwD;AACxDF,OAAK,CAACG,cAAN;AACAH,OAAK,CAACI,eAAN;AACD;;IAEoBC,U;;;;;;;;AACnB;;;;yBAIYC,K,EAAO;AACjB,UAAIA,KAAJ,EAAW;AACTA,aAAK,CAACC,SAAN,CAAgBC,GAAhB,CAAoB,2BAApB;AACD;;AACDX,UAAI,CAACU,SAAL,CAAeC,GAAf,CAAmB,eAAnB;AACAZ,UAAI,CAACa,KAAL,CAAWC,GAAX,GAAiB,CAAC,CAAD,GAAKC,MAAM,CAACC,WAA7B;AACAhB,UAAI,CAACiB,gBAAL,CAAsB,QAAtB,EAAgCd,YAAhC,EAA8C,KAA9C;AACAH,UAAI,CAACiB,gBAAL,CAAsB,WAAtB,EAAmCd,YAAnC,EAAiD;AAAEe,eAAO,EAAE;AAAX,OAAjD;AACD;AAED;;;;;;6BAGgB;AACdnB,cAAQ,CACLoB,gBADH,CACoB,4BADpB,EAEGC,OAFH,CAEW,UAAAV,KAAK;AAAA,eAAIA,KAAK,CAACC,SAAN,CAAgBU,MAAhB,CAAuB,2BAAvB,CAAJ;AAAA,OAFhB;AAGApB,UAAI,CAACU,SAAL,CAAeU,MAAf,CAAsB,eAAtB;AACArB,UAAI,CAACa,KAAL,CAAWC,GAAX,GAAiB,EAAjB;AACAd,UAAI,CAACsB,mBAAL,CAAyB,QAAzB,EAAmCnB,YAAnC,EAAiD,KAAjD;AACAH,UAAI,CAACsB,mBAAL,CAAyB,WAAzB,EAAsCnB,YAAtC,EAAoD;AAAEe,eAAO,EAAE;AAAX,OAApD;AACD;;;wBAEqB;AACpB,aAAOjB,IAAI,CAACU,SAAL,CAAeY,QAAf,CAAwB,eAAxB,CAAP;AACD;;;;;;;;;;;;;;;ACvCH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA,iBAAiB,sBAAsB;AACvC;;AAEA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,6CAA6C,+BAA+B;AAC5E;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;;;AAGA,gDAAgD;AAChD;AACA,OAAO;;AAEP;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,WAAW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ACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA,sBAAsB;AACtB;AACA,KAAK;AACL;;AAEA;AACA;AACA,mBAAmB,uBAAuB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;;AAEL;AACA,GAAG;;AAEH;AACA,CAAC;;;;;;;;;ACpZD;AAAO,IAAMkC,yBAAyB,GAAG,SAA5BA,yBAA4B,GAAM;AAC7C,MAAI,CAACrH,MAAM,CAACoU,GAAZ,EAAiB;AACf;AACD;;AAEDpU,QAAM,CAACoU,GAAP,CAAWC,iBAAX;AACArU,QAAM,CAACoU,GAAP,CAAWE,iBAAX;AACAtU,QAAM,CAACoU,GAAP,CAAWG,UAAX;AACAvU,QAAM,CAACoU,GAAP,CAAWI,YAAX;AACAxU,QAAM,CAACoU,GAAP,CAAWK,UAAX;AACD,CAVM;AAYQ;AACbpN,2BAAyB,EAAzBA;AADa,CAAf,E","file":"DynamicFeaturedCollection-StaticCollection-StaticProductRecommendations-StaticSearch.bundle.js","sourcesContent":["module.exports = debounce\n\nfunction debounce (fn, delay, at_start, guarantee) {\n  var timeout\n  var args\n  var self\n\n  return function debounced () {\n    self = this\n    args = Array.prototype.slice.call(arguments)\n\n    if (timeout && (at_start || guarantee)) {\n      return\n    } else if (!at_start) {\n      clear()\n\n      timeout = setTimeout(run, delay)\n      return timeout\n    }\n\n    timeout = setTimeout(clear, delay)\n    fn.apply(self, args)\n\n    function run () {\n      clear()\n      fn.apply(self, args)\n    }\n\n    function clear () {\n      clearTimeout(timeout)\n      timeout = null\n    }\n  }\n}\n","const { body } = document;\nconst html = document.querySelector('html');\n\nfunction _blockScroll(event) {\n  // Only block events that occur outside the modal\n  if (event.target.closest('.allow-scroll-while-locked')) return;\n  event.preventDefault();\n  event.stopPropagation();\n}\n\nexport default class ScrollLock {\n  /**\n   * Prevents all scrolling of the document\n   * @param {HTMLElement} modal Element within which scrolling is allowed\n   */\n  static lock(modal) {\n    if (modal) {\n      modal.classList.add('allow-scroll-while-locked');\n    }\n    html.classList.add('scroll-locked');\n    body.style.top = -1 * window.pageYOffset;\n    body.addEventListener('scroll', _blockScroll, false);\n    body.addEventListener('touchmove', _blockScroll, { passive: false });\n  }\n\n  /**\n   * Removes scroll lock\n   */\n  static unlock() {\n    document\n      .querySelectorAll('.allow-scroll-while-locked')\n      .forEach(modal => modal.classList.remove('allow-scroll-while-locked'));\n    html.classList.remove('scroll-locked');\n    body.style.top = '';\n    body.removeEventListener('scroll', _blockScroll, false);\n    body.removeEventListener('touchmove', _blockScroll, { passive: false });\n  }\n\n  static get isLocked() {\n    return html.classList.contains('scroll-locked');\n  }\n}\n","\n  /*!\n   * shopify-asyncview v2.0.3\n   * (c) 2019 Pixel Union\n  */\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(source, true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(source).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nvar deferred = {};\n\nvar AsyncView =\n/*#__PURE__*/\nfunction () {\n  function AsyncView() {\n    _classCallCheck(this, AsyncView);\n  }\n\n  _createClass(AsyncView, null, [{\n    key: \"load\",\n\n    /**\n     * Load the template given by the provided URL into the provided\n     * view\n     *\n     * @param {string} url - The url to load\n     * @param {object} query - An object containing additional query parameters of the URL\n     * @param {string} query.view - A required query parameter indicating which view to load\n     * @param {object} [options] - Config options\n     * @param {string} [options.hash] - A hash of the current page content\n     */\n    value: function load(url) {\n      var query = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      if (!('view' in query)) {\n        return Promise.reject(new Error('\\'view\\' not found in \\'query\\' parameter'));\n      }\n\n      var querylessUrl = url.replace(/\\?[^#]+/, '');\n      var queryParamsString = new RegExp(/.+\\?([^#]+)/).exec(url);\n      var queryParams = query;\n\n      if (queryParamsString && queryParamsString.length >= 2) {\n        queryParamsString[1].split('&').forEach(function (param) {\n          var _param$split = param.split('='),\n              _param$split2 = _slicedToArray(_param$split, 2),\n              key = _param$split2[0],\n              value = _param$split2[1];\n\n          queryParams[key] = value;\n        });\n      } // NOTE: We're adding an additional timestamp to the query.\n      // This is to prevent certain browsers from returning cached\n      // versions of the url we are requesting.\n      // See this PR for more info: https://github.com/pixelunion/shopify-asyncview/pull/4\n\n\n      var cachebustingParams = _objectSpread2({}, queryParams, {\n        _: new Date().getTime()\n      });\n\n      var hashUrl = querylessUrl.replace(/([^#]+)(.*)/, function (match, address, hash) {\n        return \"\".concat(address, \"?\").concat(Object.keys(queryParams).sort().map(function (key) {\n          return \"\".concat(key, \"=\").concat(encodeURIComponent(queryParams[key]));\n        }).join('&')).concat(hash);\n      });\n      var requestUrl = querylessUrl.replace(/([^#]+)(.*)/, function (match, address, hash) {\n        return \"\".concat(address, \"?\").concat(Object.keys(cachebustingParams).sort().map(function (key) {\n          return \"\".concat(key, \"=\").concat(encodeURIComponent(cachebustingParams[key]));\n        }).join('&')).concat(hash);\n      });\n      var promise = new Promise(function (resolve, reject) {\n        var data;\n\n        if (hashUrl in deferred) {\n          resolve(deferred[hashUrl]);\n          return;\n        }\n\n        deferred[hashUrl] = promise;\n\n        if (options.hash) {\n          data = sessionStorage.getItem(hashUrl);\n\n          if (data) {\n            var deserialized = JSON.parse(data);\n\n            if (options.hash === deserialized.options.hash) {\n              delete deferred[hashUrl];\n              resolve(deserialized);\n              return;\n            }\n          }\n        }\n\n        var xhr = new XMLHttpRequest();\n        xhr.open('GET', requestUrl, true);\n\n        xhr.onload = function () {\n          var el = xhr.response;\n          var newOptions = {};\n          var optionsEl = el.querySelector('[data-options]');\n\n          if (optionsEl && optionsEl.innerHTML) {\n            newOptions = JSON.parse(el.querySelector('[data-options]').innerHTML);\n          }\n\n          var htmlEls = el.querySelectorAll('[data-html]');\n          var newHtml = {};\n\n          if (htmlEls.length === 1 && htmlEls[0].getAttribute('data-html') === '') {\n            newHtml = htmlEls[0].innerHTML;\n          } else {\n            for (var i = 0; i < htmlEls.length; i++) {\n              newHtml[htmlEls[i].getAttribute('data-html')] = htmlEls[i].innerHTML;\n            }\n          }\n\n          var dataEls = el.querySelectorAll('[data-data]');\n          var newData = {};\n\n          if (dataEls.length === 1 && dataEls[0].getAttribute('data-data') === '') {\n            newData = JSON.parse(dataEls[0].innerHTML);\n          } else {\n            for (var _i = 0; _i < dataEls.length; _i++) {\n              newData[dataEls[_i].getAttribute('data-data')] = JSON.parse(dataEls[_i].innerHTML);\n            }\n          }\n\n          if (options.hash) {\n            try {\n              sessionStorage.setItem(hashUrl, JSON.stringify({\n                options: newOptions,\n                data: newData,\n                html: newHtml\n              }));\n            } catch (error) {\n              console.error(error);\n            }\n          }\n\n          delete deferred[hashUrl];\n          resolve({\n            data: newData,\n            html: newHtml\n          });\n        };\n\n        xhr.onerror = function () {\n          delete deferred[hashUrl];\n          reject();\n        };\n\n        xhr.responseType = 'document';\n        xhr.send();\n      });\n      return promise;\n    }\n  }]);\n\n  return AsyncView;\n}();\n\nexport default AsyncView;\n","import $ from 'jquery';\nimport debounce from 'just-debounce';\nimport VanillaModal from 'vanilla-modal';\nimport {\n  trapFocus,\n  removeTrapFocus,\n} from '@shopify/theme-a11y';\n\nimport ScrollLock from '../helpers/ScrollLock';\n\nexport default class Modal {\n  constructor(callbacks = {}) {\n    this.$body = $(document.body);\n    this.$window = $(window);\n\n    this.modal = null;\n    this.$modal = $('[data-modal-container]');\n    this.$modalInner = this.$modal.find('[data-modal-inner]');\n\n    this.trigger = null;\n\n    // Extend default vanilla-modal callbacks back to instantiator of Modal\n    this.defaultCallbacks = {\n      onOpen: () => {},\n      onClose: () => {},\n      onBeforeOpen: () => {},\n      onBeforeClose: () => {},\n    };\n\n    this.callbacks = $.extend({}, this.defaultCallbacks, callbacks);\n\n    this.finishedLoading = this.finishedLoading.bind(this);\n\n    this._onOpen = this._onOpen.bind(this);\n    this._onBeforeOpen = this._onBeforeOpen.bind(this);\n    this._onClose = this._onClose.bind(this);\n    this._onBeforeClose = this._onBeforeClose.bind(this);\n    this._closeEsc = this._closeEsc.bind(this);\n\n    this.position = this.position.bind(this);\n\n    this.modalOptions = {\n      loadClass: '',\n      class: 'modal-loaded',\n      onOpen: this._onOpen,\n      onClose: this._onClose,\n      onBeforeOpen: this._onBeforeOpen,\n      onBeforeClose: this._onBeforeClose,\n      transitions: false,\n    };\n  }\n\n  unload() {\n    if (!this.modal || !this.modal.isOpen) return;\n\n    this.modal.destroy();\n\n    ScrollLock.unlock();\n  }\n\n  /**\n   * Open a modal with contents from selector\n   *\n   * @param selector\n   * @param handle\n   */\n  open(selector, handle = 'general', trigger = null) {\n    this._addModalClass(handle);\n    this.modal = new VanillaModal(this.modalOptions);\n    this.modal.open(selector);\n    this.trigger = trigger;\n    window.addEventListener('keydown', this.closeEsc);\n  }\n\n  close() {\n    this.modal.close();\n    window.removeEventListener('keydown', this.closeEsc);\n  }\n\n  finishedLoading() {\n    trapFocus(this.$modal[0]);\n  }\n\n  _closeEsc(e) {\n    if (e.key === 'Escape') {\n      this.close();\n    }\n  }\n\n  isOpen() {\n    return this.modal && this.modal.isOpen;\n  }\n\n  /**\n   * Update the vertical positioning of modal\n   */\n  position() {\n    const windowHeight = window.innerHeight;\n\n    const modalHeight = this.$modalInner.outerHeight();\n    const modalPadding = parseInt(this.$modal.css('padding-top'), 10) * 2;\n\n    const offset = (windowHeight - modalPadding - modalHeight) / 2;\n    const marginTop = offset > 0 ? offset : 0;\n    this.$modalInner.css({ marginTop });\n  }\n\n  /**\n   * Add a class to the modal for individual styling\n   * @param handle\n   * @private\n   */\n  _addModalClass(handle) {\n    this.$modal.addClass(`modal--${handle}`);\n  }\n\n  /**\n   * Remove modal class based on the handle\n   * @private\n   */\n  _removeModalClass() {\n    const modalClass = this.$modal.attr('class').match(/modal--[\\w-]*\\b/);\n    if (!modalClass) {\n      return;\n    }\n\n    this.$modal.removeClass(modalClass[0]);\n  }\n\n  _onClose() {\n    this._removeModalClass();\n    ScrollLock.unlock();\n    this.$body.removeClass('modal-visible');\n\n    this.$window.off('resize.modal');\n\n    this.$modalInner.css({ marginTop: '' });\n\n    this.callbacks.onClose();\n\n    removeTrapFocus(this.$modal[0]);\n\n    if (this.activeElement) {\n      this.activeElement.focus();\n    }\n  }\n\n  _onOpen() {\n    this.activeElement = document.activeElement;\n    this.position();\n    ScrollLock.lock(this.$modal[0]);\n    this.$body.addClass('modal-visible');\n    this.$window.on('resize.modal', debounce(() => this.position(), 16, true, true));\n\n    this.callbacks.onOpen();\n\n    trapFocus(this.$modal[0]);\n  }\n\n  _onBeforeClose() {\n    this.callbacks.onBeforeClose();\n  }\n\n  _onBeforeOpen() {\n    this.callbacks.onBeforeOpen();\n  }\n}\n","/**\n * Allows a callback to be run once, when a target intersects the viewport.\n * @constructor\n * @param {HTMLElement} target Element to track\n * @param {Function} callback Function to execute when target enters viewport (only executed once)\n * @param {Object} [options] options with which to construct the IntersectionObserver\n * @param {string} [options.rootMargin='30%'] A string which specifies a set of offsets to add to the root's bounding_box when calculating intersections.\n * @param {number} [options.threshold=0] Ratio of intersection required to trigger callback\n */\nexport default class LazyLoader {\n  constructor(target, callback, options) {\n    const defaultOptions = {\n      rootMargin: '30%',\n      threshold: 0,\n    };\n\n    this.callback = callback;\n    this._runCallback = this._runCallback.bind(this);\n\n    this.observer = new IntersectionObserver(this._runCallback, { ...defaultOptions, ...options });\n    this.observer.observe(target);\n  }\n\n  /**\n   * Runs the callback if first entry becomes intersecting, then unloads the LazyLoader\n   * @_runCallback\n   * @param {IntersectionObserverEntry[]} entries Entry to check - all but the\n   * first element will be ignored.\n   */\n  _runCallback(entries) {\n    // do nothing unless target moved into state of intersection\n    if (entries[0].isIntersecting === true) {\n      this.unload();\n      this.callback();\n    }\n  }\n\n  /**\n   * Disconnects IntersectionObserver if active\n   * @unload\n   */\n  unload() {\n    this.observer.disconnect();\n  }\n}\n","import $ from 'jquery';\nimport AsyncView from 'shopify-asyncview';\n\nimport Modal from './Modal';\nimport ProductDetails from './ProductDetails';\nimport RichText from './RichText';\nimport { initShopifyProductReviews } from '../helpers/ProductReviews';\nimport { setupRippleEffect } from '../helpers/Ripple';\n\nexport default class ProductQuickshop {\n  constructor(options) {\n    this.$el = options.$el;\n    this.id = options.id;\n    this.initialVariant = options.initialVariant || null;\n    this.quickShopSelector = `#shopify-section-${this.id} [data-product-quickshop]`;\n    this.$quickShop = $(this.quickShopSelector);\n    this.quickshopSpinner = this.$quickShop[0].querySelector('.quickshop-spinner');\n    this.modalClass = options.modalClass;\n    this.loaded = false;\n    this.richText = null;\n    this.productDetails = null;\n    this.trigger = options.trigger;\n    this.isOpen = false;\n    this.openingAddToCart = false;\n\n    this.url = this.$el.data('product-quickshop-url');\n    this.hash = this.$el.data('quickshop-hash');\n\n    this.modalCallbacks = {\n      onOpen: this._open.bind(this),\n      onClose: this._close.bind(this),\n    };\n\n    this.atcCallbacks = {\n      onInit: this._onATCInit.bind(this),\n      onError: this._onATCError.bind(this),\n      onSuccess: this._onATCSuccess.bind(this),\n      onClose: this._onATCClose.bind(this),\n    };\n\n    this._initialize();\n  }\n\n  _initialize() {\n    this.modal = new Modal(this.modalCallbacks);\n    this.modal.open(\n      this.quickShopSelector,\n      this.modalClass,\n      this.trigger,\n    );\n    this.isOpen = true;\n\n    const $quickShopModalContent = this.modal.$modalInner.find('[data-modal-content]');\n\n    AsyncView.load(\n      this.url,\n      { view: '_quickshop' },\n      { hash: this.hash },\n    ).then(({ html, data }) => {\n      // Stop populating the modal if it was closed before the content was loaded\n      if (!this.isOpen) { return; }\n\n      $quickShopModalContent.html(html.content);\n\n      initShopifyProductReviews();\n      setupRippleEffect($quickShopModalContent[0]);\n\n      if (window.Shopify && Shopify.PaymentButton) {\n        Shopify.PaymentButton.init();\n      }\n\n      this.$message = $quickShopModalContent.find('[data-product-quickshop-message]');\n      this.$formArea = $quickShopModalContent.find('[data-product-form-area]');\n      this.gallery = $quickShopModalContent[0].querySelector('[data-product-gallery]');\n      this.$details = $quickShopModalContent.find('[data-product-details]');\n      this.$description = $quickShopModalContent.find('[data-product-description]');\n      this.context = data.context;\n      this.settings = data.settings;\n      this.product = data.product;\n\n      this._onQuickshopLoaded();\n    }).catch();\n  }\n\n  _onQuickshopLoaded() {\n    if (this.loaded) {\n      return;\n    }\n\n    if (this.$description && this.$description.length) {\n      this.richText = new RichText(this.$description);\n    }\n\n    const options = {\n      $formArea: this.$formArea,\n      gallery: this.gallery,\n      $details: this.$details,\n      atcCallbacks: this.atcCallbacks,\n      context: this.context,\n      settings: this.settings,\n      product: this.product,\n      useHistory: false,\n      isQuickshop: true,\n      initialVariant: this.initialVariant,\n    };\n\n    this.modal.position();\n    this.modal.finishedLoading();\n    this.loaded = true;\n\n    window.requestAnimationFrame(() => {\n      this.productDetails = new ProductDetails(options);\n    });\n  }\n\n  _open() {\n    // do nothing\n  }\n\n  _close() {\n    if (this.productDetails) {\n      this.productDetails.unload();\n    }\n\n    if (this.richText) {\n      this.richText.unload();\n    }\n\n    if (!this.openingAddToCart) {\n      this.trigger.focus();\n    }\n\n    this.loaded = false;\n    this.isOpen = false;\n    this.$quickShop.empty();\n    this.$quickShop.html(this.quickshopSpinner);\n    this._toggleMessage('', false);\n    this.modal.unload();\n  }\n\n  _toggleMessage(message, isVisible) {\n    if (this.$message) {\n      this.$message\n        .html(message)\n        .toggleClass('visible', isVisible);\n    }\n  }\n\n  _onATCInit() {\n    this.openingAddToCart = true;\n    this.$message.removeClass('visible');\n  }\n\n  _onATCError(error) {\n    const $content = $(`<div class=\"product-message--error\" tabindex=\"-1\">${error}</div>`);\n    this._toggleMessage($content, true);\n    $content.focus();\n  }\n\n  _onATCSuccess() {\n    this._close();\n  }\n\n  _onATCClose() {\n    // Do nothing\n  }\n\n  unload() {\n    this._close();\n  }\n}\n","import EventHandler from '@pixelunion/events';\nimport debounce from 'just-debounce';\nimport rimg from 'rimg-shopify';\nimport AsyncView from 'shopify-asyncview';\n\nlet swatchGap = null;\n\nexport default class GridItemSwatches {\n  constructor(options) {\n    this.el = options.el;\n    this.setInitialVariant = options.setInitialVariant;\n\n    this.expanded = false;\n    this.swatchImages = {};\n    this.swatchVariantIds = {};\n    this.selectedImage = null;\n    this.state = {};\n    this.events = new EventHandler();\n\n    this.data = JSON.parse(this.el.querySelector('[data-swatch-data]').innerHTML);\n    this.variants = this.data.variants;\n\n    this.swatchesContainer = this.el.querySelector('[data-swatches-container]');\n    this.cardLinks = this.el.querySelectorAll('[data-product-page-link]');\n    this.cardLinkHref = this.cardLinks[0].getAttribute('href');\n    this.activeControlTime = 0;\n    this.activeControl = this.swatchesContainer.querySelector('[checked]');\n    this.isPreselected = !!this.activeControl;\n\n    this.swatches = this.swatchesContainer.querySelectorAll('[data-swatch]');\n    this.swatchCount = this.swatches.length;\n    this.swatchCountWrapper = this.el.querySelector('[data-swatch-count-wrapper]');\n    this.swatchCount = this.swatchCountWrapper.querySelector('[data-swatch-count]');\n    this.swatchWidths = Array.prototype.map.call(this.swatches, swatch => swatch.getBoundingClientRect().width);\n    this.resize();\n    this.el.querySelector('[data-swatches]').classList.add('processed');\n\n    this.originalImages = {\n      primary: this.el.querySelector('.productitem--image-primary'),\n      alternate: this.el.querySelector('.productitem--image-alternate'),\n    };\n\n    this.disableUnavailable();\n\n    // +/- button expansion events\n    this.events.register(window, 'resize', debounce(() => this.resize(), 50));\n    this.events.register(this.swatchCountWrapper, 'click', () => this._toggleExpanded());\n\n    // Image injection events\n    this.injectImagesMouseoverEvent = this.events.register(this.el, 'mouseover', () => this._injectImages());\n    this.injectImagesFocusinEvent = this.events.register(this.el, 'focusin', () => this._injectImages());\n\n    // Image/swatch switching events\n    this.events.register(this.swatchesContainer, 'mouseover', e => this._handleMouseOver(e));\n    this.events.register(this.swatchesContainer, 'mouseleave', e => this._handleMouseLeave(e));\n    this.events.register(this.swatchesContainer, 'click', e => this._handleClick(e));\n    this.events.register(this.swatchesContainer, 'change', e => this._handleChange(e));\n    this.events.register(this.swatchesContainer, 'focusin', e => this._handleSwatchFocus(e));\n  }\n\n  disableUnavailable() {\n    if (!this.variants) {\n      return;\n    }\n\n    const availableSwatches = {};\n\n    this.variants.forEach(variant => {\n      if (variant.available) {\n        availableSwatches[variant[this.data.swatchOptionKey]] = true;\n      }\n    });\n\n    const swatchInputs = this.swatchesContainer.querySelectorAll('input[name=\"swatch\"]');\n\n    swatchInputs.forEach(swatch => {\n      if (!(swatch.value in availableSwatches)) {\n        swatch.disabled = true;\n      }\n    });\n  }\n\n  resize() {\n    if (this.expanded) this._toggleExpanded();\n\n    const availableWidth = this.swatchesContainer.getBoundingClientRect().width\n      - parseInt(window.getComputedStyle(this.swatchesContainer).paddingRight, 10);\n\n    let newShowSwatchCount = this.swatches.length;\n    let cumulativeWidth = 0;\n\n    for (let i = 0; i < this.swatches.length; i++) {\n      if (cumulativeWidth + this.getSwatchGap() + this.swatchWidths[i] < availableWidth) {\n        cumulativeWidth += swatchGap + this.swatchWidths[i];\n      } else {\n        newShowSwatchCount = i;\n        break;\n      }\n    }\n\n    if (newShowSwatchCount === this.showSwatchCount) return;\n\n    this.showSwatchCount = newShowSwatchCount;\n\n    this.swatches.forEach((swatch, index) => {\n      if (index < this.showSwatchCount) {\n        swatch.classList.add('productitem--swatches-swatch-visible');\n        swatch.classList.remove('productitem--swatches-swatch-hidden');\n      } else {\n        swatch.classList.remove('productitem--swatches-swatch-visible');\n        swatch.classList.add('productitem--swatches-swatch-hidden');\n      }\n    });\n\n    this.swatchCountWrapper.style.left = `${cumulativeWidth}px`;\n\n    if (this.swatches.length > this.showSwatchCount) {\n      this.swatchCountWrapper.style.display = 'flex';\n      this.swatchCount.innerText = `+${this.swatches.length - this.showSwatchCount}`;\n    } else {\n      this.swatchCountWrapper.style.display = 'none';\n    }\n  }\n\n  _injectImages() {\n    this.events.unregister(this.injectImagesFocusinEvent);\n    this.events.unregister(this.injectImagesMouseoverEvent);\n\n    AsyncView.load(this.cardLinkHref, { view: '_swatch-data' }, { hash: this.data.hash })\n      .then(({ data }) => {\n        if (this.imagesInjected) return;\n        this.imagesInjected = true;\n        const tempContainer = document.createDocumentFragment();\n\n        if (data.featuredImage) {\n          const tempEl = document.createElement('div');\n          tempEl.innerHTML = data.featuredImage;\n          const img = tempEl.querySelector('img');\n          tempContainer.appendChild(img);\n          this.featuredImage = img;\n        }\n\n        data.swatches.forEach(({ swatchValue, imageString, variantId }) => {\n          this.swatchVariantIds[swatchValue] = variantId;\n          if (imageString) {\n            const tempEl = document.createElement('div');\n            tempEl.innerHTML = imageString;\n            const img = tempEl.querySelector('img');\n            tempContainer.appendChild(img);\n            this.swatchImages[swatchValue] = img;\n          }\n        });\n        const imagesContainer = this.el.querySelector('[data-product-item-image]');\n        const salesBadge = imagesContainer.querySelector('[data-badge-sales]');\n\n        imagesContainer.insertBefore(tempContainer, salesBadge);\n        rimg.watch(imagesContainer);\n\n        this._setState({\n          swatchName: this.activeControl ? this.activeControl.value : null,\n          primaryImage: this.originalImages.primary,\n          hideAlternateImage: !!this.activeControl,\n        });\n      });\n  }\n\n  _setState({ swatchName, primaryImage, hideAlternateImage }) {\n    const oldPrimaryImg = this.state.primaryImage;\n\n    const href = swatchName ? `${this.cardLinkHref}?variant=${this.swatchVariantIds[swatchName]}` : this.cardLinkHref;\n    this.cardLinks.forEach(link => link.setAttribute('href', href));\n\n    this.setInitialVariant(this.swatchVariantIds[swatchName] || this.variants[0].id);\n\n    if (oldPrimaryImg) {\n      oldPrimaryImg.classList.remove('productitem--image-primary');\n      oldPrimaryImg.style.visibility = '';\n    }\n\n    if (primaryImage) {\n      primaryImage.classList.add('productitem--image-primary');\n      primaryImage.style.visibility = hideAlternateImage ? 'visible' : '';\n    }\n\n    if (this.originalImages.alternate) {\n      this.originalImages.alternate.style.visibility = hideAlternateImage ? 'hidden' : '';\n    }\n\n    this.state = { swatchName, primaryImage, hideAlternateImage };\n  }\n\n  _handleChange({ target }) {\n    this.activeControlTime = Date.now();\n    this.activeControl = target;\n    const swatchName = target.value;\n    this.selectedImage = this.swatchImages[swatchName] || this.originalImages.primary;\n    this._setState({\n      swatchName,\n      primaryImage: this.selectedImage,\n      hideAlternateImage: true,\n    });\n  }\n\n  _handleClick({ target }) {\n    if (target === this.activeControl && this.activeControlTime + 150 < Date.now()) {\n      // Allow deselection, if swatch has been active for more than the threshold\n      // because we can't guarantee the order of the click and change events\n      target.checked = false;\n      this.activeControl = null;\n      this.selectedImage = null;\n\n      // Swaps in featured image if card was rendered on server with preselected swatch variant image.\n      if (this.isPreselected && this.featuredImage) {\n        this.originalImages.primary = this.featuredImage;\n        this.isPreselected = false;\n      }\n\n      this._setState({\n        swatchName: null,\n        primaryImage: this.state.primaryImage,\n        hideAlternateImage: true,\n      });\n    }\n  }\n\n  _handleMouseOver(event) {\n    if (event.target.hasAttribute('data-swatch-tooltip')) {\n      this._setState({\n        swatchName: this.state.swatchName,\n        primaryImage: this.swatchImages[event.target.dataset.swatchTooltip] || this.originalImages.primary,\n        hideAlternateImage: true,\n      });\n    }\n  }\n\n  _handleMouseLeave({ target }) {\n    if (target.hasAttribute('data-swatches-container')) {\n      this._setState({\n        swatchName: this.state.swatchName,\n        primaryImage: this.selectedImage || this.originalImages.primary,\n        hideAlternateImage: !!this.selectedImage,\n      });\n    }\n  }\n\n  _handleSwatchFocus({ target }) {\n    if (this.expanded === false && target.nextElementSibling.classList.contains('productitem--swatches-swatch-hidden')) {\n      this._toggleExpanded();\n    }\n  }\n\n  _toggleExpanded() {\n    const swatchesEl = this.el.querySelector('[data-swatches]');\n\n    if (this.expanded) {\n      this.expanded = false;\n      swatchesEl.classList.remove('productitem--swatches-expanded');\n      this.swatchCount.innerText = `+${this.swatches.length - this.showSwatchCount}`;\n    } else {\n      this.expanded = true;\n      swatchesEl.classList.add('productitem--swatches-expanded');\n    }\n  }\n\n  // Getters are used to avoid having to get these properties for every card on the page\n  getSwatchGap() {\n    if (swatchGap === null) {\n      swatchGap = parseInt(window.getComputedStyle(this.swatches[0]).getPropertyValue('margin-right'), 10);\n    }\n    return swatchGap;\n  }\n\n  unload() {\n    this.events.unregisterAll();\n  }\n}\n","import $ from 'jquery';\nimport $script from 'scriptjs';\nimport EventHandler from '@pixelunion/events';\nimport { transition } from '@pixelunion/animations';\n\nimport layout from '../Layout';\nimport LazyLoader from '../helpers/LazyLoader';\nimport ProductQuickshop from './ProductQuickshop';\nimport AddToCartFlyout from './AddToCartFlyout';\nimport GridItemSwatches from './GridItemSwatches';\n\nexport default class ProductGridItem {\n  constructor(options) {\n    this.el = options.el;\n    this.$el = $(options.el);\n    this.id = options.id;\n    this.productQuickshop = null;\n    this.quickshopInitialVariant = null;\n    this.quickBuySettings = null;\n    this.actionsOpen = false;\n    this.defaultView = options.grid_list;\n\n    this.events = new EventHandler();\n\n    if (options.lazy) {\n      this.lazyLoader = new LazyLoader(this.$el[0], () => this._init());\n    } else {\n      this._init();\n    }\n  }\n\n  _init() {\n    this.$window = $(window);\n    this.$html = $('html');\n    this.content = this.el.querySelector('[data-product-item-content]');\n    this.actions = this.el.querySelector('[data-product-actions]');\n    this.swatchesEl = this.el.querySelector('[data-swatches]');\n    this.quickBuyEl = this.el.querySelector('[data-quick-buy]');\n    this.quickshopSlimEl = this.el.querySelector('[data-quickshop-slim]');\n    this.quickshopFullEl = this.el.querySelector('[data-quickshop-full]');\n\n    this.hasProductActions = this.actions !== null;\n\n    this._addToCart = this._addToCart.bind(this);\n    this._actionsToggle = this._actionsToggle.bind(this);\n    this._openQuickShop = this._openQuickShop.bind(this);\n\n    if (this.hasProductActions) {\n      this._setSortByQueryParameters();\n      if (this.$html.hasClass('no-touch') && this.defaultView !== 'list-view') {\n        this.events.register(this.el, 'mouseenter', e => this._actionsToggle(e));\n        this.events.register(this.el, 'mouseleave', e => this._actionsToggle(e));\n        this.events.register(this.el, 'focusin', e => this._actionsToggle(e));\n      }\n      // $scripts checks existence of script in header before attempting to inject\n      $script($('[data-scripts]').data('shopify-api-url'), () => {\n        this.events.register(this.quickBuyEl, 'click', e => this._addToCart(e));\n        this.events.register(this.quickshopSlimEl, 'click', e => this._openQuickShop(e));\n        this.events.register(this.quickshopFullEl, 'click', e => this._openQuickShop(e));\n      });\n    }\n\n    this.expandAnimation = transition({ el: this.content, state: 'closed' });\n\n    if (this.quickbuyEl !== null) {\n      this._initQuickBuy();\n    }\n\n    this._objectFitPolyfill();\n\n    if (this.swatchesEl) {\n      this.swatches = new GridItemSwatches({\n        el: this.$el[0],\n        setInitialVariant: id => { this.quickshopInitialVariant = id; },\n        product: this.product,\n      });\n    }\n  }\n\n  /**\n   * Make Shopify aware of releavent collection search info\n   *  - tag\n   *  - vendor\n   *  - pagination\n   *  - sorting criteria\n   *\n   * @private\n   */\n  _setSortByQueryParameters() {\n    Shopify.queryParams = {};\n    if (location.search.length) {\n      for (let i = 0, aCouples = location.search.substr(1).split('&'); i < aCouples.length; i++) {\n        const aKeyValue = aCouples[i].split('=');\n        // Reset the page number when we apply (i.e. don't add it to params)\n        if (aKeyValue.length > 1 && aKeyValue[0] !== 'page') {\n          Shopify.queryParams[decodeURIComponent(aKeyValue[0])] = decodeURIComponent(aKeyValue[1]);\n        }\n      }\n    }\n  }\n\n  _initQuickBuy() {\n    try {\n      this.quickBuySettings = JSON.parse(this.$el.find('[data-quick-buy-settings]').text());\n    } catch (error) {\n      console.warn(`Quick buy: invalid QuickBuy data found. ${error.message}`);\n    }\n  }\n\n  _openQuickShop(event) {\n    event.preventDefault();\n\n    const leftThumbsClass = event.currentTarget.hasAttribute('data-thumbs-left')\n      ? ' quickshop-thumbs-left'\n      : '';\n\n    const modalClass = event.currentTarget.hasAttribute('data-quickshop-full')\n      ? `quickshop-full${leftThumbsClass}`\n      : 'quickshop-slim';\n\n    if (this.productQuickshop) {\n      this.productQuickshop.unload();\n    }\n\n    this.productQuickshop = new ProductQuickshop({\n      $el: this.$el,\n      id: this.id,\n      modalClass,\n      trigger: this.$el.find('.productitem--title a'),\n      initialVariant: this.quickshopInitialVariant,\n    });\n  }\n\n  _isObjectFitAvailable() {\n    return 'objectFit' in document.documentElement.style;\n  }\n\n  _objectFitPolyfill() {\n    if (this._isObjectFitAvailable()) {\n      return;\n    }\n\n    const $figure = $('[data-product-item-image]', this.$el);\n    const featuredSrc = $('img:not(.productitem--image-alternate)', $figure).attr('src');\n    const alternateSrc = $('.productitem--image-alternate', $figure).attr('src');\n\n    $figure.addClass('product-item-image-no-objectfit');\n    $figure.css('background-image', `url(\"${featuredSrc}\")`);\n\n    if (alternateSrc) {\n      this.events.register(this.el, 'mouseover', () => {\n        $figure.css('background-image', `url(\"${alternateSrc}\")`);\n      });\n\n      this.events.register(this.el, 'mouseleave', () => {\n        $figure.css('background-image', `url(\"${featuredSrc}\")`);\n      });\n    }\n  }\n\n  /**\n   * Get height of element, and combined height of element + actions\n   *\n   * @returns {{heightBase, heightExpanded: *}}\n   * @private\n   */\n  _getHeights() {\n    const { height } = this.el.getBoundingClientRect();\n    const actionsHeight = this.actions.getBoundingClientRect().height;\n\n    return {\n      heightBase: height,\n      heightExpanded: height + actionsHeight,\n    };\n  }\n\n  _actionsToggle(event) {\n    if (!layout.isGreaterThanBreakpoint('M')) return;\n\n    const $currentTarget = $(event.currentTarget);\n    const $target = $(event.target);\n\n    let openProductItem = false;\n\n    // This function gets called on the element as well as the document focusin, so we want to\n    // be extra careful that we are inside the product card in question. We want the product card\n    // to close if another product card has received focus.\n    const productHasFocus = this.$el.is($currentTarget)\n      || this.$el.is($target)\n      || this.$el.is($target.parents('.productgrid--item').first())\n      || (event.type === 'focusin' && $target[0].contains(this.$el[0]));\n\n    if (event.type === 'mouseenter' || event.type === 'mouseleave') {\n      openProductItem = event.type === 'mouseenter';\n    } else if (productHasFocus) {\n      openProductItem = true;\n    }\n\n    if (openProductItem) {\n      this._showActions();\n    } else {\n      this._hideActions();\n    }\n  }\n\n  _showActions() {\n    if (this.actionsOpen) { return; }\n\n    const { heightBase, heightExpanded } = this._getHeights();\n\n    this.el.style.setProperty('--base-height', `${heightBase}px`);\n    this.el.style.setProperty('--open-height', `${heightExpanded}px`);\n\n    // Store set the outer grid item to be open so it knows to adjust its z-index\n    this.el.setAttribute('data-open', '');\n\n    // Start animation, and transition base height to expanded height (in CSS)\n    this.expandAnimation.animateTo('open');\n\n    this.focusinEvent = this.events.register(document, 'focusin', e => this._actionsToggle(e));\n\n    this.actionsOpen = true;\n  }\n\n  _hideActions() {\n    this.expandAnimation.animateTo('closed').then(() => {\n      this.el.removeAttribute('data-open');\n    });\n\n    this.events.unregister(this.focusinEvent);\n\n    this.actionsOpen = false;\n  }\n\n  _addToCart(event) {\n    event.preventDefault();\n\n    if (this.addToCartFlyout) {\n      this.addToCartFlyout.unload();\n    }\n\n    const atcButton = event.currentTarget;\n    const variantID = atcButton.getAttribute('data-variant-id');\n\n    const formData = [\n      {\n        name: 'id',\n        value: variantID,\n      },\n      {\n        name: 'quantity',\n        value: 1,\n      },\n    ];\n\n    const options = {\n      atcButton,\n      settings: {\n        moneyFormat: this.quickBuySettings.money_format,\n        cartRedirection: this.quickBuySettings.cart_redirection,\n      },\n    };\n\n    this.addToCartFlyout = new AddToCartFlyout(formData, options);\n  }\n\n  unload() {\n    this.events.unregisterAll();\n\n    if (this.productQuickshop) {\n      this.productQuickshop.unload();\n    }\n\n    document.removeEventListener('focusin', this._actionsToggle);\n\n    if (this.swatches) {\n      this.swatches.unload();\n    }\n    this.lazyLoader.unload();\n  }\n}\n","(function (global, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    define(['exports'], factory);\n  } else if (typeof exports !== \"undefined\") {\n    factory(exports);\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(mod.exports);\n    global.VanillaModal = mod.exports;\n  }\n})(this, function (exports) {\n  'use strict';\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  var _createClass = function () {\n    function defineProperties(target, props) {\n      for (var i = 0; i < props.length; i++) {\n        var descriptor = props[i];\n        descriptor.enumerable = descriptor.enumerable || false;\n        descriptor.configurable = true;\n        if (\"value\" in descriptor) descriptor.writable = true;\n        Object.defineProperty(target, descriptor.key, descriptor);\n      }\n    }\n\n    return function (Constructor, protoProps, staticProps) {\n      if (protoProps) defineProperties(Constructor.prototype, protoProps);\n      if (staticProps) defineProperties(Constructor, staticProps);\n      return Constructor;\n    };\n  }();\n\n  var _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  var defaults = {\n    modal: '.modal',\n    modalInner: '.modal-inner',\n    modalContent: '.modal-content',\n    open: '[data-modal-open]',\n    close: '[data-modal-close]',\n    page: 'body',\n    class: 'modal-visible',\n    loadClass: 'vanilla-modal',\n    clickOutside: true,\n    closeKeys: [27],\n    transitions: true,\n    transitionEnd: null,\n    onBeforeOpen: null,\n    onBeforeClose: null,\n    onOpen: null,\n    onClose: null\n  };\n\n  function throwError(message) {\n    // eslint-disable-next-line no-console\n    console.error('VanillaModal: ' + message);\n  }\n\n  function find(arr, callback) {\n    return function (key) {\n      var filteredArray = arr.filter(callback);\n      return filteredArray[0] ? filteredArray[0][key] : undefined;\n    };\n  }\n\n  function transitionEndVendorSniff() {\n    var el = document.createElement('div');\n    var transitions = [{ key: 'transition', value: 'transitionend' }, { key: 'OTransition', value: 'otransitionend' }, { key: 'MozTransition', value: 'transitionend' }, { key: 'WebkitTransition', value: 'webkitTransitionEnd' }];\n    return find(transitions, function (_ref) {\n      var key = _ref.key;\n      return typeof el.style[key] !== 'undefined';\n    })('value');\n  }\n\n  function isPopulatedArray(arr) {\n    return Object.prototype.toString.call(arr) === '[object Array]' && arr.length;\n  }\n\n  function getNode(selector, parent) {\n    var targetNode = parent || document;\n    var node = targetNode.querySelector(selector);\n    if (!node) {\n      throwError(selector + ' not found in document.');\n    }\n    return node;\n  }\n\n  function addClass(el, className) {\n    if (!(el instanceof HTMLElement)) {\n      throwError('Not a valid HTML element.');\n    }\n    el.setAttribute('class', el.className.split(' ').filter(function (cn) {\n      return cn !== className;\n    }).concat(className).join(' '));\n  }\n\n  function removeClass(el, className) {\n    if (!(el instanceof HTMLElement)) {\n      throwError('Not a valid HTML element.');\n    }\n    el.setAttribute('class', el.className.split(' ').filter(function (cn) {\n      return cn !== className;\n    }).join(' '));\n  }\n\n  function getElementContext(e) {\n    if (e && typeof e.hash === 'string') {\n      return document.querySelector(e.hash);\n    } else if (typeof e === 'string') {\n      return document.querySelector(e);\n    }\n    throwError('No selector supplied to open()');\n    return null;\n  }\n\n  function applyUserSettings(settings) {\n    return _extends({}, defaults, settings, {\n      transitionEnd: transitionEndVendorSniff()\n    });\n  }\n\n  function matches(e, selector) {\n    var allMatches = (e.target.document || e.target.ownerDocument).querySelectorAll(selector);\n    for (var i = 0; i < allMatches.length; i += 1) {\n      var node = e.target;\n      while (node && node !== document.body) {\n        if (node === allMatches[i]) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n    }\n    return null;\n  }\n\n  var VanillaModal = function () {\n    function VanillaModal(settings) {\n      _classCallCheck(this, VanillaModal);\n\n      this.isOpen = false;\n      this.current = null;\n      this.isListening = false;\n\n      this.settings = applyUserSettings(settings);\n      this.dom = this.getDomNodes();\n\n      this.open = this.open.bind(this);\n      this.close = this.close.bind(this);\n      this.closeKeyHandler = this.closeKeyHandler.bind(this);\n      this.outsideClickHandler = this.outsideClickHandler.bind(this);\n      this.delegateOpen = this.delegateOpen.bind(this);\n      this.delegateClose = this.delegateClose.bind(this);\n      this.listen = this.listen.bind(this);\n      this.destroy = this.destroy.bind(this);\n\n      this.addLoadedCssClass();\n      this.listen();\n    }\n\n    _createClass(VanillaModal, [{\n      key: 'getDomNodes',\n      value: function getDomNodes() {\n        var _settings = this.settings,\n            modal = _settings.modal,\n            page = _settings.page,\n            modalInner = _settings.modalInner,\n            modalContent = _settings.modalContent;\n\n        return {\n          modal: getNode(modal),\n          page: getNode(page),\n          modalInner: getNode(modalInner, getNode(modal)),\n          modalContent: getNode(modalContent, getNode(modal))\n        };\n      }\n    }, {\n      key: 'addLoadedCssClass',\n      value: function addLoadedCssClass() {\n        addClass(this.dom.page, this.settings.loadClass);\n      }\n    }, {\n      key: 'setOpenId',\n      value: function setOpenId(id) {\n        var page = this.dom.page;\n\n        page.setAttribute('data-current-modal', id || 'anonymous');\n      }\n    }, {\n      key: 'removeOpenId',\n      value: function removeOpenId() {\n        var page = this.dom.page;\n\n        page.removeAttribute('data-current-modal');\n      }\n    }, {\n      key: 'open',\n      value: function open(allMatches, e) {\n        var page = this.dom.page;\n        var _settings2 = this.settings,\n            onBeforeOpen = _settings2.onBeforeOpen,\n            onOpen = _settings2.onOpen;\n\n        if (!(this.current instanceof HTMLElement === false)) {\n          throwError('VanillaModal target must exist on page.');\n          return;\n        }\n        this.releaseNode(this.current);\n        this.current = getElementContext(allMatches);\n        if (typeof onBeforeOpen === 'function') {\n          onBeforeOpen.call(this, e);\n        }\n        this.captureNode(this.current);\n        addClass(page, this.settings.class);\n        this.setOpenId(this.current.id);\n        this.isOpen = true;\n        if (typeof onOpen === 'function') {\n          onOpen.call(this, e);\n        }\n      }\n    }, {\n      key: 'detectTransition',\n      value: function detectTransition() {\n        var modal = this.dom.modal;\n\n        var css = window.getComputedStyle(modal, null);\n        return Boolean(['transitionDuration', 'oTransitionDuration', 'MozTransitionDuration', 'webkitTransitionDuration'].filter(function (i) {\n          return typeof css[i] === 'string' && parseFloat(css[i]) > 0;\n        }).length);\n      }\n    }, {\n      key: 'close',\n      value: function close(e) {\n        var _settings3 = this.settings,\n            transitions = _settings3.transitions,\n            transitionEnd = _settings3.transitionEnd,\n            onBeforeClose = _settings3.onBeforeClose;\n\n        var hasTransition = this.detectTransition();\n        if (this.isOpen) {\n          this.isOpen = false;\n          if (typeof onBeforeClose === 'function') {\n            onBeforeClose.call(this, e);\n          }\n          removeClass(this.dom.page, this.settings.class);\n          if (transitions && transitionEnd && hasTransition) {\n            this.closeModalWithTransition(e);\n          } else {\n            this.closeModal(e);\n          }\n        }\n      }\n    }, {\n      key: 'closeModal',\n      value: function closeModal(e) {\n        var onClose = this.settings.onClose;\n\n        this.removeOpenId(this.dom.page);\n        this.releaseNode(this.current);\n        this.isOpen = false;\n        this.current = null;\n        if (typeof onClose === 'function') {\n          onClose.call(this, e);\n        }\n      }\n    }, {\n      key: 'closeModalWithTransition',\n      value: function closeModalWithTransition(e) {\n        var _this = this;\n\n        var modal = this.dom.modal;\n        var transitionEnd = this.settings.transitionEnd;\n\n        var closeTransitionHandler = function closeTransitionHandler() {\n          modal.removeEventListener(transitionEnd, closeTransitionHandler);\n          _this.closeModal(e);\n        };\n        modal.addEventListener(transitionEnd, closeTransitionHandler);\n      }\n    }, {\n      key: 'captureNode',\n      value: function captureNode(node) {\n        var modalContent = this.dom.modalContent;\n\n        while (node.childNodes.length) {\n          modalContent.appendChild(node.childNodes[0]);\n        }\n      }\n    }, {\n      key: 'releaseNode',\n      value: function releaseNode(node) {\n        var modalContent = this.dom.modalContent;\n\n        while (modalContent.childNodes.length) {\n          node.appendChild(modalContent.childNodes[0]);\n        }\n      }\n    }, {\n      key: 'closeKeyHandler',\n      value: function closeKeyHandler(e) {\n        var closeKeys = this.settings.closeKeys;\n\n        if (isPopulatedArray(closeKeys) && closeKeys.indexOf(e.which) > -1 && this.isOpen === true) {\n          e.preventDefault();\n          this.close(e);\n        }\n      }\n    }, {\n      key: 'outsideClickHandler',\n      value: function outsideClickHandler(e) {\n        var clickOutside = this.settings.clickOutside;\n        var modalInner = this.dom.modalInner;\n\n        if (clickOutside) {\n          var node = e.target;\n          while (node && node !== document.body) {\n            if (node === modalInner) {\n              return;\n            }\n            node = node.parentNode;\n          }\n          this.close(e);\n        }\n      }\n    }, {\n      key: 'delegateOpen',\n      value: function delegateOpen(e) {\n        var open = this.settings.open;\n\n        var matchedNode = matches(e, open);\n        if (matchedNode) {\n          e.preventDefault();\n          this.open(matchedNode, e);\n        }\n      }\n    }, {\n      key: 'delegateClose',\n      value: function delegateClose(e) {\n        var close = this.settings.close;\n\n        if (matches(e, close)) {\n          e.preventDefault();\n          this.close(e);\n        }\n      }\n    }, {\n      key: 'listen',\n      value: function listen() {\n        var modal = this.dom.modal;\n\n        if (!this.isListening) {\n          modal.addEventListener('click', this.outsideClickHandler, false);\n          document.addEventListener('keydown', this.closeKeyHandler, false);\n          document.addEventListener('click', this.delegateOpen, false);\n          document.addEventListener('click', this.delegateClose, false);\n          this.isListening = true;\n        } else {\n          throwError('Event listeners already applied.');\n        }\n      }\n    }, {\n      key: 'destroy',\n      value: function destroy() {\n        var modal = this.dom.modal;\n\n        if (this.isListening) {\n          this.close();\n          modal.removeEventListener('click', this.outsideClickHandler);\n          document.removeEventListener('keydown', this.closeKeyHandler);\n          document.removeEventListener('click', this.delegateOpen);\n          document.removeEventListener('click', this.delegateClose);\n          this.isListening = false;\n        } else {\n          throwError('Event listeners already removed.');\n        }\n      }\n    }]);\n\n    return VanillaModal;\n  }();\n\n  exports.default = VanillaModal;\n});\n","export const initShopifyProductReviews = () => {\n  if (!window.SPR) {\n    return;\n  }\n\n  window.SPR.registerCallbacks();\n  window.SPR.initRatingHandler();\n  window.SPR.initDomEls();\n  window.SPR.loadProducts();\n  window.SPR.loadBadges();\n};\n\nexport default {\n  initShopifyProductReviews,\n};\n"],"sourceRoot":""}